function [TVAf] = LPF2d(TVA_1, TVA_2, TVA_3, TVA_4, TVAf_1, TVAf_2, TVAf_3, TVAf_4)
    
    a = 0.0009023;
    b = 0.008355;
    c = 0.007118;
    d = 0.0005582;

    e = -3.0800;
    f =  3.7130;
    g = -2.0650;
    h =  0.4493;

TVAf = a*TVA_1 + b*TVA_2 + c*TVA_3 + d*TVA_4 - e*TVAf_1 - f*TVAf_2 - g*TVAf_3 -h*TVAf_4;

% s = tf('s');
% T = 1/40;
% D = 0.5;
% 
% LPF = 1 / ( 1+2*D*T*s + T^2*s^2 );
% LPF2 = LPF*LPF;
% LPF2d = c2d(LPF2, 0.01)

%         0.0009023 z^3 + 0.008355 z^2 + 0.007118 z + 0.0005582
% LPF2d = -----------------------------------------------------
%              z^4 - 3.08 z^3 + 3.713 z^2 - 2.065 z + 0.4493

%               a z^3 + b z^2 + c z + d
% LPF2d = -------------------------------
%         z^4 + e z^3 + f z^2 + g z + h

% y[k] = a*u[k-1] + b*u[k-2] + c*u[k-3] + d*u[k-4] - e*y[k-1] - f*y[k-2] - g*y[k-3] - h*y[k-4]
